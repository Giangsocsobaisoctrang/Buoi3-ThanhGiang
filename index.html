<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Products Dashboard - EscuelaJS</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1a2e;
      --card:#101f3b;
      --muted:#9fb0cc;
      --line:rgba(255,255,255,.08);
      --accent:#7c5cff;
    }
    body{ background: linear-gradient(180deg,#0a1020 0%, #0a1020 30%, #0b1220 100%); color:#e9eef8; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .muted{ color: var(--muted); }

    /* Layout */
    .app{
      min-height: 100vh;
      display:grid;
      grid-template-columns: 290px 1fr;
      gap: 18px;
      padding: 18px;
      max-width: 1400px;
      margin: 0 auto;
    }
    @media (max-width: 992px){
      .app{ grid-template-columns: 1fr; }
      .sidebar{ position: static !important; }
    }

    .sidebar{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 16px;
      position: sticky;
      top: 18px;
      height: fit-content;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }

    .brand{
      display:flex; align-items:center; gap:10px;
      padding: 10px 10px 14px 10px;
      border-bottom: 1px solid var(--line);
      margin-bottom: 14px;
    }
    .logo{
      width:40px; height:40px; border-radius: 14px;
      background: radial-gradient(circle at 30% 30%, #a08bff, #5b34ff);
      box-shadow: 0 12px 22px rgba(92,52,255,.35);
    }
    .brand h4{ margin:0; font-size: 1.05rem; }
    .brand .sub{ font-size:.82rem; color: var(--muted); }

    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 10px;
      border: 1px solid var(--line);
      border-radius: 999px;
      background: rgba(255,255,255,.03);
      color:#e9eef8;
      font-size:.85rem;
    }

    .content{
      display:flex;
      flex-direction:column;
      gap: 14px;
    }

    .topbar{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 14px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }

    .kpi{
      display:grid;
      grid-template-columns: 1.2fr 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 1200px){
      .kpi{ grid-template-columns: 1fr; }
    }
    .kpi .box{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 12px;
    }
    .kpi .label{ font-size:.82rem; color: var(--muted); }
    .kpi .value{ font-size: 1.1rem; font-weight: 700; margin-top: 4px; }

    /* Table area */
    .panel{
      background: rgba(255,255,255,.03);
      border: 1px solid var(--line);
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .panel-head{
      padding: 14px;
      border-bottom: 1px solid var(--line);
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .panel-title{
      display:flex; align-items:baseline; gap:10px; flex-wrap:wrap;
    }
    .panel-title h5{ margin:0; }
    .panel-title .api{ color: var(--muted); font-size:.85rem; }

    /* Controls */
    .control-row{
      display:grid;
      grid-template-columns: 1fr 210px 1fr;
      gap: 10px;
      padding: 14px;
      border-bottom: 1px solid var(--line);
    }
    @media (max-width: 992px){
      .control-row{ grid-template-columns: 1fr; }
    }

    .form-control, .form-select{
      background: rgba(255,255,255,.04) !important;
      border: 1px solid var(--line) !important;
      color:#e9eef8 !important;
    }
    .form-control::placeholder{ color: rgba(233,238,248,.55); }
    .form-select option{ color:#111; } /* dropdown items */

    /* Buttons */
    .btn-accent{
      background: linear-gradient(135deg, #8a73ff, #5b34ff);
      border: 0;
      color: white;
      box-shadow: 0 12px 24px rgba(92,52,255,.28);
    }
    .btn-accent:hover{ filter: brightness(1.05); }

    /* Table */
    .table{
      margin: 0;
      color:#e9eef8;
    }
    .table thead th{
      background: rgba(255,255,255,.02);
      color: #dce6ff;
      border-bottom: 1px solid var(--line);
      padding: 12px 14px;
      vertical-align: middle;
    }
    .table tbody td{
      border-top: 1px solid var(--line);
      padding: 12px 14px;
      vertical-align: middle;
    }
    .table-hover tbody tr:hover{
      background: rgba(124,92,255,.08);
      cursor: pointer;
    }

    .thumb {
      width: 44px; height: 44px; object-fit: cover;
      border-radius: 12px; border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
    }
    .ellipsis {
      max-width: 320px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Pagination bar */
    .panel-foot{
      padding: 12px 14px;
      border-top: 1px solid var(--line);
      display:flex;
      flex-wrap:wrap;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
    }
    .pagination .page-link{
      background: rgba(255,255,255,.04);
      border: 1px solid var(--line);
      color:#e9eef8;
    }
    .pagination .page-item.active .page-link{
      background: rgba(124,92,255,.35);
      border-color: rgba(124,92,255,.55);
      color:#fff;
    }

    /* Modals keep readable on dark bg */
    .modal-content{
      background: #0f1a2e;
      border: 1px solid var(--line);
      color:#e9eef8;
    }
    .modal-header, .modal-footer{
      border-color: var(--line);
    }
    .badge.text-bg-light.border{
      background: rgba(255,255,255,.06) !important;
      color:#e9eef8 !important;
      border-color: var(--line) !important;
    }
  </style>
</head>

<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <h4 class="mb-1">Products</h4>
          <div class="sub">Dashboard (EscuelaJS)</div>
        </div>
      </div>

      <div class="d-flex flex-column gap-2">
        <div class="chip">
          <span class="mono">API</span>
          <span class="muted text-truncate" title="https://api.escuelajs.co/api/v1/products">
            https://api.escuelajs.co/api/v1/products
          </span>
        </div>

        <div class="d-flex gap-2 mt-2">
          <button class="btn btn-accent w-100" id="btnOpenCreate">+ Tạo sản phẩm</button>
        </div>

        <button class="btn btn-outline-success w-100" id="btnExportCsv">
          Export CSV (view hiện tại)
        </button>

        <div class="mt-3 p-3 rounded-4" style="background: rgba(255,255,255,.03); border:1px solid var(--line);">
          <div class="small muted mb-1">Mẹo</div>
          <ul class="small mb-0 muted">
            <li>Click 1 dòng để mở chi tiết</li>
            <li>“Edit” để bật sửa, rồi “Lưu (PUT)”</li>
            <li>Export CSV xuất theo bộ lọc/sort hiện tại</li>
          </ul>
        </div>
      </div>
    </aside>

    <!-- Main -->
    <main class="content">
      <!-- Top bar / KPIs -->
      <section class="topbar">
        <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
          <div>
            <h3 class="mb-0">Products Dashboard</h3>
            <div class="muted small">Quản lý danh sách sản phẩm + CRUD + Export</div>
          </div>
          <span class="badge text-bg-light border" id="countBadge">0 items</span>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="label">Trạng thái</div>
            <div class="value">Đang hoạt động</div>
            <div class="small muted">Lọc / Sort / Phân trang realtime</div>
          </div>
          <div class="box">
            <div class="label">Nguồn dữ liệu</div>
            <div class="value mono">EscuelaJS API</div>
            <div class="small muted">GET / POST / PUT</div>
          </div>
          <div class="box">
            <div class="label">Xuất dữ liệu</div>
            <div class="value">CSV</div>
            <div class="small muted">Theo view hiện tại</div>
          </div>
        </div>
      </section>

      <!-- Table panel -->
      <section class="panel">
        <div class="panel-head">
          <div class="panel-title">
            <h5 class="mb-0">Danh sách sản phẩm</h5>
            <span class="api mono">/api/v1/products</span>
          </div>
          <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-outline-light btn-sm" id="sortTitleBtn">Sort Title</button>
            <button class="btn btn-outline-light btn-sm" id="sortPriceBtn">Sort Price</button>
          </div>
        </div>

        <div class="control-row">
          <div>
            <label class="form-label small muted mb-1">Tìm theo title</label>
            <input id="searchInput" class="form-control" placeholder="Gõ để lọc ngay..." />
          </div>

          <div>
            <label class="form-label small muted mb-1">Số item / trang</label>
            <select id="pageSizeSelect" class="form-select">
              <option value="5">5 / trang</option>
              <option value="10" selected>10 / trang</option>
              <option value="20">20 / trang</option>
            </select>
          </div>

          <div class="d-flex align-items-end justify-content-end">
            <div class="muted small" id="pageInfo">Trang 1</div>
          </div>
        </div>

        <div class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
              <tr>
                <th style="width:90px;">ID</th>
                <th>Title</th>
                <th style="width:160px;">Price</th>
                <th style="width:200px;">Category</th>
                <th style="width:260px;">Images</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

        <div class="panel-foot">
          <div class="muted small">Điều hướng</div>
          <nav>
            <ul class="pagination mb-0" id="pagination"></ul>
          </nav>
        </div>
      </section>
    </main>
  </div>

  <!-- Detail/Edit Modal -->
  <div class="modal fade" id="detailModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Chi tiết sản phẩm</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <div id="detailAlert"></div>

          <div class="row g-3">
            <div class="col-12 col-md-3">
              <label class="form-label">ID</label>
              <input class="form-control mono" id="d_id" disabled />
            </div>

            <div class="col-12 col-md-9">
              <label class="form-label">Title</label>
              <input class="form-control" id="d_title" disabled />
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Price</label>
              <input class="form-control" id="d_price" type="number" disabled />
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Category ID</label>
              <input class="form-control" id="d_categoryId" type="number" disabled />
            </div>

            <div class="col-12 col-md-6">
              <label class="form-label">Images (comma-separated)</label>
              <input class="form-control" id="d_images" disabled />
            </div>

            <div class="col-12">
              <label class="form-label">Description</label>
              <textarea class="form-control" id="d_description" rows="4" disabled></textarea>
            </div>

            <div class="col-12">
              <div class="d-flex flex-wrap gap-2" id="d_preview"></div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-outline-light" id="btnEditToggle">Edit</button>
          <button class="btn btn-accent" id="btnSaveEdit" disabled>Lưu (PUT)</button>
          <button class="btn btn-outline-danger" data-bs-dismiss="modal">Đóng</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Create Modal -->
  <div class="modal fade" id="createModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Tạo sản phẩm mới</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <div id="createAlert"></div>

          <div class="row g-3">
            <div class="col-12 col-md-9">
              <label class="form-label">Title</label>
              <input class="form-control" id="c_title" />
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Price</label>
              <input class="form-control" id="c_price" type="number" />
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Category ID</label>
              <input class="form-control" id="c_categoryId" type="number" />
              <div class="form-text muted">Ví dụ: 1, 2, 3...</div>
            </div>

            <div class="col-12 col-md-9">
              <label class="form-label">Images (comma-separated)</label>
              <input class="form-control" id="c_images" placeholder="https://...jpg, https://...png" />
            </div>

            <div class="col-12">
              <label class="form-label">Description</label>
              <textarea class="form-control" id="c_description" rows="4"></textarea>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-accent" id="btnCreate">Tạo (POST)</button>
          <button class="btn btn-outline-danger" data-bs-dismiss="modal">Đóng</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Your JS -->
  <script src="./main.js"></script>
</body>
</html>
